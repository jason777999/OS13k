<meta charset=utf-8><style>body{opacity:0;margin:0;overflow:hidden;font-family:arial;font-size:22;user-select:none;white-space:nowrap;background:#000}#menu{display:flex;flex-direction:column;background:#000}.programMenu{background:linear-gradient(#fff,#777)}#menu,.programMenu{visibility:hidden;position:absolute;z-index:20000;box-shadow:5px 5px 9px;border:2px solid}.program{font-size:18;height:18;padding:4}.activeWindow{border:3px solid #aaa}#taskbar{position:absolute;z-index:10000;width:100%;background:linear-gradient(#888,#333);box-shadow:0px 1px 9px;border:2px solid;left:-2}.taskbarIcon{width:50;height:40;text-shadow:1px 1px 3px #000}.programActive,.taskbarIconActive{background:linear-gradient(#ff8,#fff)}.taskbarIcon:hover{background:linear-gradient(#fff,#44f)}#tray{margin:2;padding-left:9;padding-right:9;color:#fff;background:linear-gradient(#000,#333);border:1px solid;border-radius:6px;text-shadow:1px 1px 3px #000}.trayIcon{padding:2}.trayIcon:hover{background:#fff3}.popup{position:relative;z-index:10000;width:200;padding:8;pointer-events:none;white-space:normal;text-align:center;background:linear-gradient(#eee,#888);box-shadow:9px 9px 19px;border:2px solid;border-radius:9px}.trophyIcon{padding:9;font-size:40;text-shadow:2px 2px 4px;white-space:nowrap}#background{position:absolute;width:100%;height:100%;color:#0002;font-family:impact;font-size:30vw;font-weight:900;position:absolute}.program,#taskbar,.taskbarIcon,#background,#tray{display:flex;align-items:center;justify-content:center}</style><template id=T><style>:host{visibility:hidden;position:absolute;background:#000;box-shadow:5px 5px 9px;border:3px solid #222;border-radius:6px;overflow:hidden}.titlebar{height:34;font-size:24;display:flex;align-items:center;white-space:nowrap;background:linear-gradient(#ccc,#444);border-bottom:3px solid}.titlebarActive{background:linear-gradient(#eee,#88f)}.titlebarActiveUser{background:linear-gradient(#eee,#8f8)}.titlebarActiveSticky{background:linear-gradient(#eee,#f88)}.titlebarSticky{background:linear-gradient(#ccc,#844)}#name{width:100%;overflow:hidden;cursor:grab}#icon{display:inline;text-shadow:1px 1px 3px #000;margin-left:9;margin-right:9;pointer-events:none}#frame{width:100%;height:100%;background:#fff;border:none;visibility:hidden}#codeDisplay{display:none}#codeText{height:99;background:#000;color:#fff}#errorText{background:#000;color:#f00}#codeOptions{background:#111;color:#fff;font-size:16;padding:10;overflow:auto}#codeText,#errorText,#codeOptions{width:100%;resize:none;outline:0}#full:hover{background:#fff}#help:hover{background:#0ff}#code:hover{background:#f0f}#shrink:hover{background:#0ff}#grow:hover{background:#0f0}#reload:hover{background:#ff0}#close:hover{background:#f00}</style></template><div id=background></div><div id=desktop><div id=taskbar><div id=taskbarSpace style=flex:1></div><div id=tray></div></div><div id=popups style=float:right></div><div id=programsMenu style=position:absolute></div><div id=menu> <button id=buttonFullScreen>Full Screen <button id=buttonCode>Code <button id=buttonHelp>Help <button id=buttonResetSize>Reset Size <button id=buttonReload>Reload <button id=buttonClose>Close <script>"use strict";const aa=[[,"‚ùå",,,128,"Close All"],["help.html","<b><span style=color:#0f0>?",380,400,1,,"Check here to see help when available.\nSome programs have a option to show code instead.\n\nHave fun! ‚úåÔ∏èüòÑ"],[,"‚öôÔ∏è",,,,"System",,[["system/settings.html","üéöÔ∏è",470,190,1],["system/trophyCase.html","üèÜ",,,25],["system/clock.dweet.js","üï∞Ô∏è",200,200,37],["system/systemTest.html",,600,370,58],[,"üìÅ",,,,"Test",,[["index.html","‚úåÔ∏èüòÑ",,,,"Meta OS13k"]]]]],[,"üõ†Ô∏è",,,,"Apps",,[["apps/stickyNote.html","‚úçÔ∏è",300,263,3,,"Ctrl+B - Bold\nCtrl+I - Italic\nCtrl+U - Underline\nReload to clear"],["apps/timer.html","‚è∞",400,136,2|close]]],[,"üé∂",,,,"Music",,[["music/musicPlayer.html","üéµ",400,330,1],["music/piano.html","üéπ",500,510,10,,"Keyboard = Play Notes\nUp/Down = Change Octave"],["music/soundSeeds.html","üå±",350,480,close],["music/visualizer.dweet.js","üëÅÔ∏è",,,60]]],[,"üòÄ",,,,"User Programs",,[[,"üìå",,,256,"New User Program"],[,"‚ö†Ô∏è",,,512,"Clear User Programs"]]]];function ba(e,t,i=44100){const n=p.createBuffer(e.length,e[0].length,i);return i=p.createBufferSource(),e.map((e,t)=>n.getChannelData(t).set(e)),i.buffer=n,e=i.gain=p.createGain(),i.connect(e),e.connect(t?z:A),i.start(),i}class ca{Clamp(e,t=0,i=1){return Math.min(Math.max(e,t),i)}Percent(e,t,i){return i-t?this.Clamp((e-t)/(i-t),0,1):0}Lerp(e,t,i){return t+this.Clamp(e,0,1)*(i-t)}Hash(e){return[...e].reduce((e,t)=>t.charCodeAt()+31*e|0,0)}Random(e=1,t=0){return this.randomSeed^=(this.randomSeed||1)<<13,this.randomSeed^=this.randomSeed>>17,this.randomSeed^=this.randomSeed<<5,this.Percent(Math.abs(this.randomSeed)%1e9/1e9,t,e)}Trophy(e="",t="",i="",n="",s="ja"){var a=e=>(e+"").replace(/`/g,"'").replace(/,/g,"");e=a(e),i=a(i),t=a(t),n=a(n),t=this.StripHTML(t,32,1),i=this.StripHTML(i,32,1),e=this.StripHTML(e,32,1),n=this.StripHTML(n,32,1);const o=e+`,${t},`+i;if(!(0<=(a=C.findIndex(e=>e[4]==o))&&C[a][3]==n)){var r=[e,i,t,n,o];0>a?C.unshift(r):C[a]=r,localStorage["OS13kTrophy,"+o]=n,D.a&&D.a.window&&E(D.a.window),i||e&&(i=e,e=""),this.Popup(`<div class=trophyIcon>${t||"üèÜ"}</div><div><b>${i}</b><br><i>${e}</i></div>`+n,i||e,s),OS13k.h()}}GetTrophy(e,t){const i=C.findIndex(i=>i[0]==e&i[1]==t);return 0>i?0:C[i][3]}Trophies(){return C}PlaySeed(e,t=1,i=1,n=.05,s,a){return this.PlaySamples(this.SeedSamples(...arguments),a)}SeedSamples(e,t=1,i=1,n=.05,s){return zzfxG(...this.SeedParameters(...arguments))}SeedParameters(e,t=1,i=1,n=.05,s){if(parseFloat(e=(e+"").trim())!=e){if("zzfx(...["==e.slice(0,9)){for(var a of(i=[],e.slice(9).split(",")))i.push(a.length?parseFloat(a):void 0);return i}e=OS13k.Hash(e)}this.randomSeed=e,t=this.Clamp(t,0,5),a=(e=(()=>this.Random()))()**3/4*t;const o=e()**3/4*t,r=e()**3/4*t,h=a+o+r+(t*=e()**3/4),l=2e3*e()**2;return[i,n,s||l,a,r,t,5*e()|0,3*e()**2,(.5>e()?e():0)**3*(.5>e()&&e()?99:-99),(.5>e()?e():0)**3*(.5>e()&&e()?99:-99),(.5>e()?e():0)**2*(.5>e()&&e()?1e3:-1e3),e()**2*h,(.5>e()?e():0)*h,(.5>e()?e():0)**4,(.5>e()?e():0)**3*(.5>e()&&e()?9:-9),(.5>e()?e():0)**4,(.5>e()?e():0)**3/2,1-(.5>e()?e():0),o]}PlaySamples(e,t,i=44100){return ba([e],t,i)}PlayMusic(e){try{return ba(fa(...e),1)}catch(e){console.log(e)}}GetAnalyser(){return G}GetAnalyserData(){return ha}Note(e=0,t=440){return t*2**(e/12)}Speak(e,t=1,i=1,n=1,s="en",a){(e=new SpeechSynthesisUtterance(e)).volume=n*A.gain.value*3,e.pitch=i,e.rate=t,e.lang=s,a&&H.StopSpeech(),settings.s&&I&&speechSynthesis&&speechSynthesis.speak(e)}CreateShader(e,t){const i=(e=e.getContext("webgl2")).createShader(35633);e.shaderSource(i,"#version 300 es\nin vec4 c;void main(){gl_Position=c;}"),e.compileShader(i),e.bindBuffer(34962,e.createBuffer()),e.bufferData(34962,new Int8Array([-3,1,1,-3,1,1]),35044),e.enableVertexAttribArray(0),e.vertexAttribPointer(0,2,5120,0,0,0);const n=e.createShader(35632);if(e.shaderSource(n,"#version 300 es\nprecision mediump float;uniform float iTime;uniform int iFrame;uniform vec4 iMouse;uniform vec3 iResolution;uniform sampler2D iChannel0;out vec4 c;\n"+t+"\nvoid main(){mainImage(c,gl_FragCoord.xy);c.a=1.;}"),e.compileShader(n),!e.getShaderParameter(n,35713))throw e.getShaderInfoLog(n);return e.bindTexture(3553,e.createTexture()),e.texParameteri(3553,10241,9729),e.pixelStorei(37440,1),t=e.createProgram(),e.attachShader(t,i),e.attachShader(t,n),e.linkProgram(t),e.useProgram(t),t}RenderShader(e,t,i,n,s,a,o,r){const h=e.getContext("webgl2");h.uniform3f(h.getUniformLocation(t,"iResolution"),e.width,e.height,1),h.uniform1f(h.getUniformLocation(t,"iTime"),i),h.uniform1f(h.getUniformLocation(t,"iFrame"),n),h.uniform1i(h.getUniformLocation(t,"iChannel0"),0),h.uniform4f(h.getUniformLocation(t,"iMouse"),s,a,o,r),h.viewport(0,0,e.width,e.height),h.drawArrays(6,0,3),h.texImage2D(3553,0,6408,6408,5121,e)}KeyDirection(e){let t=0,i=0;return 87==e|38==e&&++i,83==e|40==e&&--i,68==e|39==e&&++t,65==e|37==e&&--t,{x:t,y:i}}StripHTML(e,t){return(e+="").substring(0,t||e.length).replace(/<.*>/g,"")}Popup(e,t,i){const n=popups.appendChild(document.createElement("div"));n.className="popup",n.innerHTML=e,n.speak=t,n.aa=i,n.style.visibility="hidden"}h(){I&&(localStorage.OS13k=JSON.stringify({t:C,s:settings,Z:L,p:M,n:ia})),(A.gain.value=settings.v)||H.StopSpeech(),z.gain.value=settings.m,settings.s||H.StopSpeech(),background.style.background=`linear-gradient(${settings.c},${settings.d})`,background.innerText=settings.t,background.style.filter=desktop.style.filter=settings.f}SaveSettings(e,t,i,n,s,a,o,r,h){this.h(settings={v:A.gain.value=e,m:z.gain.value=t,s:i,p:n,o:s,c:a,d:o,t:r,f:h})}Settings(){return settings}}var OS13k=new ca;const p=new AudioContext,A=p.createGain(),z=p.createGain(),ja=p.createAnalyser();let N,ka,la,I,O,ma,oa,R,S,G,qa,Y,M,D,sa,ta,ua,ia=0,ha=[],pa=-1e4,ra=0,U=0,V=0,W=9,X=53,L=[],C=[],settings={v:.3,m:.3,s:1,p:1,o:1,c:"#222233",d:"#332222",t:"OS13k",f:""};function va(e){const t=e?e.split(","):[];return"OS13kTrophy"==t.shift()&&OS13k.Trophy(...t,localStorage[e])}function wa(){U|I||(Y&&self==top|Y.sticky&&Y.l(Y=0),I=1,OS13k.h())}function xa(){[...programsMenu.children].map(e=>e.style.visibility=menu.style.visibility=""),ma&&(ma.className="program")}function Z(e,t){V&&settings.o&&OS13k.PlaySeed(e,t)}class ya{U(e){requestAnimationFrame(H.U);var t=document.activeElement;(t=t.shadowRoot&&t.shadowRoot.activeElement==t.B?t.B:0)&&qa!=t&&document.activeElement.b(V=1),qa=t,U||(document.body.style.opacity=Math.min(1,.02+1*document.body.style.opacity)),D.innerHTML=C.length+" üèÜ",ta.title=new Date,ta.innerHTML=ta.title.replace(/.*(\d+:\d+):.*/,"$1"),ja.fftSize=64,t=new Uint8Array(G.width=G.height=32);const i=G.getContext("2d");ja.getByteFrequencyData(t);let n=0;for(;32>n;){const s=t[n]/255*(1+Math.log10(44100*(n+1)/64));i.fillStyle=`hsl(${-99-69*s} 99%50%)`,i.fillRect(n,31,1,-8*s),ha[n++]=OS13k.Clamp(s/5,0,1),s&&(pa=e)}if(G.style.display=1e4>e-pa?"":"none",I&&V){var s=0;[...popups.children].map((e,t)=>{if(e.speak&&OS13k.Speak(e.speak,1,1,1,e.aa),e.speak=0,settings.p){if(!document.fullscreenElement){let i=e.style.visibility?innerHeight:parseFloat(e.style.top)+s-9;e.style.visibility="",44>i&&(i=44,t||(e.style.opacity=(e.style.opacity||3)-.01)||(t=e.getBoundingClientRect(),s+=t.height,popups.removeChild(e))),e.style.top=i}}else popups.removeChild(e)})}}StopSpeech(){speechSynthesis&&speechSynthesis.cancel()}}const H=new ya;function za(e,t=0){e.L||(programsMenu.innerHTML=""),e.innerHTML="",programsMenu.appendChild(e),e.C.map(t=>e.appendChild(t.a)),e.style.top=t,e.style.left=e.L?e.L.getBoundingClientRect().right-2:programsMenu.style.left=0,e.C.map(i=>{i.a.u!=e&&za(i.a.u,t),t+=26})}function Aa(e,t){const i=new Ba(...t?[,t.icon,t.width,t.height,58,t.name+" (Copy)",,,++ia]:[,"‚úã",,,58,,,,++ia]);return e.C.push({a:i}),i.u=e,za(R.D),i.g=1,i.info.code=t?t.info.code:'// Auto detects HTML, Dweet, or Shadertoy! ‚úåÔ∏èüòÑ\nfor(x.fillRect(0,0,i=s=2e3,s);i--;x.fillStyle="#0001")\nx.clearRect((S(i)*1e9-t*i/9)%s,i*9%s,i%9,i%9)',t&&(i.info.scale=t.info.scale,W=t.info.x,X=t.info.y+37),i.l(S=1),Ca(i.window,1),i.window.i.focus(),i}class Da extends HTMLElement{constructor(e,t){super(),this.className="programMenu",this.L=t,this.C=e;for(const i of e)(t=i.a=new Ba(...i)).u=t.R?new Da(t.R,this):this,512&t.flags&&L.map(t=>null!=t.code&&e.push([,t.icon,t.width,t.height,58,t.name,,,t.id]))}b(){xa(),this.L&&this.L.b(),this.style.visibility="visible"}}function Ea(e){const t=L.findIndex(t=>t.id==e.id);e.info=0>t?{}:L[t]}customElements.define("m-",Da);class Ba extends HTMLElement{constructor(e="",t="üí†",i=720,n=405,s,a="",o="",r,h){super();var l=e.split(".");let d=l[0].split("/");d=d[d.length-1].replace(/([a-z](?=[A-Z]))/g,"$1 "),a=a||d&&d[0].toUpperCase()+d.slice(1),l=e?l[1]:"",this.N="dweet"==l,this.isShader="shader"==l,this.className="program",this.src=e,this.width=i,this.height=n,this.R=r,this.id=h||a,this.I(t,a),this.code=!(this.K=o)&&(32&s||(this.N||this.isShader)&&null==s),this.flags=s=s||26,this.sticky=1&s,this.reload=2&s,this.P=4&s,this.S=8&s,this.resize=16&s,Ea(this),this.g=null!=this.info.code,"Settings"==a&&Fa(sa,this),"Trophy Case"==a&&Fa(D,this),"Clock"==a&&Fa(ta,this),"Music Player"==a&&Fa(ua,this),"Help"==a&&null==this.info.open&&(Y=this),this.sticky?this.info.open&&this.l():this.id==M&&(Y=this)}I(e,t){this.innerHTML="";const i=this.appendChild(document.createElement("div"));i.style="pointer-events:none;width:45;text-shadow:1px 1px 3px #000;text-align:center",i.innerHTML=this.icon=e,this.innerHTML+=`<div style=flex:1;padding-right:9;pointer-events:none>${this.name=OS13k.StripHTML(t)||"User Program "+this.id}</div>`+(this.R?"‚ñ∂":"")}T(){this.u.b(),ma!=this&&Z(90,0),ma=this,this.className="program programActive"}l(){if(this.window)return this.window.b(1,1),!1;if(this.src||this.g){let e=this.info.x,t=this.info.y;return e||(e=W,t=X,400<(W+=37)&&(W=X=9),300<(X+=37)&&(X=X=53)),this.window=new Ga(this,e,t),this.h(),!1}if(256&this.flags)return Aa(this.u),!1;128&this.flags&&([...desktop.children].map(e=>e.A&&e.A()),W=9,X=53,OS13k.Trophy("OS13k","‚òï","Coffee Is For Closers","Closed All")),512&this.flags&&confirm(this.name+"?")&&(this.u.C=this.u.C.filter(e=>!e.a.g||(e.a.window&&e.a.window.A(),!1)),L=L.filter(e=>null==e.code),OS13k.h(),za(R.D))}b(){this.l()}h(e=1){this.info={open:e,id:this.id,x:e|this.sticky?parseInt(this.window.style.left):0,y:parseInt(this.window.style.top),scale:e|this.sticky?this.window.scale:1,name:this.name,icon:this.icon,width:this.width,height:this.height,code:this.info.code,F:this.g?this.window.F.checked:1,G:this.window.G.checked},0>(e=L.findIndex(e=>e.id==this.id))?L.push(this.info):L[e]=this.info,OS13k.h()}}function E(e,t,i=1){e.a.g&&(e.a.info.code=e.i.value),e.a.h(),O.b(1,i),e.j&&e.j.OS13kReload?e.j.OS13kReload():e.a.g?Ha(e,e.a.info.code):e.j.location.reload(e.B.style.visibility=""),t||Z(85)}function Na(e){e.a.S&&(S||E(e,S=1),e.w.webkitRequestFullScreen&&e.w.webkitRequestFullScreen(),e.w.mozRequestFullScreen&&e.w.mozRequestFullScreen(),Z(-9),OS13k.Trophy("OS13k","üïπÔ∏è","Pro Gamer","Went Full Screen"))}function Ca(e,t){e.M.style.display=(e.$=!e.$)?"inline":"",O.b(1,1),t||Z(e.a.K?48:16),e.a.K||OS13k.Trophy("OS13k","üë®‚Äçüíª","Hacker","Viewed Code")}function Oa(e,t,i){i&&Z(i),t=OS13k.Clamp(e.a.width*t,250,1920),i=e.a.height*(e.scale=t/e.a.width),e.style.left=parseFloat(e.style.left)+parseFloat(e.style.width)-t,e.style.width=t,e.w.style.height=i,e.a.h()}function Pa(e){const t=()=>{s.g&&("<"!=s.info.code.trim()[0]?s.N=!(s.isShader=0<=s.info.code.search(/void\s+mainImage/)):s.N=s.isShader=0);const t=s.N||s.isShader,o=!e.a.g||S;e.X.disabled=!t||!o,s.g&&(n.onerror=((t,i,n,s,a)=>(e.J.value=a,!0)));const r=n.document,h=s.g?s.info.code:s.K||r.body[t?"innerText":"innerHTML"];if(s.g||(e.i.value=h),n.OS13k=OS13k,n.zzfx=Qa,n.zzfxG=zzfxG,o||(r.body.style.background="#000"),t&&o)try{Ra(e,`<canvas id=c width=1920 height=1080 style=width:100%;background:${s.isShader?"#000":"#fff"}>`),r.body.style="background:#111;overflow:hidden;margin:0;display:flex;align-items:center";const t=s.g&&!s.isShader?"OS13kL=0;"+h.replace(/(for\s*\((?!\s+of\s+)(?!\s+in\s+)[^;]*;[^;]*;|while\s*\()\s*(\S)/g,(e,t,i)=>t&&i?t+"++OS13kL>1e5&&(u=e=>{throw'Timed out!'})()"+(")"==i?"":",")+i:e):h;n.OS13kWindow=e,s.g&&(n.onerror=((t,i,n,s,a)=>(e.J.value=a,!0))),n.eval("frame=0;"+(s.isShader?`x=c.getContext('webgl2',${s.g?"{preserveDrawingBuffer:true}":""});`+"onmousemove=e=>e.buttons&&(X=e.x,Y=c.height-e.y);onmousedown=e=>(X=Z=e.x,Y=W=c.height-e.y);onmouseup=e=>Z=W=0;s=parent.OS13k.CreateShader(c,`"+t+"`);u=t=>(c.width=innerWidth,c.height=innerHeight,parent.OS13k.RenderShader(c,s,t,frame++,X,Y,Z,W));OS13k_=t=>requestAnimationFrame(OS13k_,"+(s.P||!s.info.F?"":"t<1e3|parent.document.activeElement==OS13kWindow&&")+"u(t/1e3));OS13k_(X=Y=Z=W=0)":"x=c.getContext`2d`;S=Math.sin;C=Math.cos;T=Math.tan;OS13k=parent.OS13k;zzfx=parent.zzfx;R=(r,g,b,a=1)=>`rgba(${0|r},${0|g},${0|b},${a})`;u=t=>{"+t+"\n};OS13k_=t=>(requestAnimationFrame(OS13k_),"+(s.P||!s.info.F?"":"t<1e3|parent.document.activeElement==OS13kWindow&&")+"t>OS13kF-2&&u(((t=frame++/60)*60|0==frame-1)&&t>0?t+1e-6:t, OS13kF=Math.max(OS13kF+1000/60,t)));OS13k_(OS13kF=0)"))}catch(t){if(e.J.value=t&&t.message?t.message:t,!s.g)throw t}o||(n.onmousedown=(t=>(E(e,S=1),onmousedown(t)))),n.da=n.ca=n.oncontextmenu=(()=>!1),e.H||(e.H=new Sa(s,e)).b(),e.style.visibility=e.B.style.visibility="visible",U=U&&--U,wa(),s.g&&(i.onload=(()=>a++&&E(e,1,0)))},i=e.B=e.w.appendChild(document.createElement("iframe")),n=e.j=i.contentWindow,s=e.a;let a=0;i.id="frame",s.g?(e.J.value="",e.i.onkeydown=(t=>!t.altKey||(13==t.keyCode&&Ha(e,e.i.value),18!=t.keyCode)),e.i.oninput=(()=>e.G.checked&&Ha(e,e.i.value)),e.i.onmousedown=(t=>(S||e.G.checked&&E(e,S=1),t)),Ra(e,s.info.code),t()):(e.B.src=s.src+"?v22",i.onload=(()=>t()))}function Ra(e,t){const i=e.j.document;i.open(),e.j.onerror=((t,i,n,s,a)=>(e.J.value=a,!0)),e.a.g&&!S||i.write(t),i.close()}function Ha(e,t){e.a.info.code=t,e.Y.innerHTML=t.length,e.a.h(),S=1,e.w.removeChild(e.B),Pa(e)}customElements.define("p-",Ba);class Ga extends HTMLElement{constructor(e,t,i){super(),desktop.appendChild(this),this.a=e,this.style.left=t,this.style.top=i,this.W=1,this.V=0,this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML=T.innerHTML,this.O=this.shadowRoot.appendChild(document.createElement("div")),this.O.id="titlebar",this.name=this.O.appendChild(document.createElement("div")),this.name.id="name";const n=()=>{this.name.innerHTML="";const t=this.name.appendChild(document.createElement("div"));t.id="icon",t.innerHTML=e.icon,this.name.innerHTML+=e.name};n(),t=((e,t,i,n="path")=>{const s=this.O.appendChild(document.createElement("div"));s.id=e,s.title=t,s.innerHTML=`<svg style=height:100%;width:28;pointer-events:none viewBox='0 0 10 10'><${n} stroke=#000 fill=none ${i} />`}),e.resize&&t("grow","Grow",'d="M2 5L8 5M5 8L5 2"',t("shrink","Shrink",'d="M2 5L8 5"')),e.S&&t("full","Full Screen","x=1 y=2 width=8 height=6","rect"),e.K&&t("help","Help",'d="M5 8L8 2L2 2L5 8L8 2"'),e.code&&t("code","Code",'d="M5 2L8 8L2 8L5 2L8 8"'),e.reload&&t("reload","Reload","cx=5 cy=5 r=3","circle"),t("close","Close",'d="M2 2L8 8M8 2L2 8"'),(this.w=this.shadowRoot.appendChild(document.createElement("div"))).style.background="#000",(this.M=this.shadowRoot.appendChild(document.createElement("div"))).id="codeDisplay",(this.i=this.M.appendChild(document.createElement("textarea"))).id="codeText",e.g?this.i.value=e.info.code:this.i.setAttribute("readOnly",!0),this.i.setAttribute("spellcheck",!1),(t=this.M.appendChild(document.createElement("div"))).id="codeOptions",e.g||(t.style.display="none"),t.innerHTML="Icon <input style=width:35 id=I> Name <input id=N> Size <input style=width:50 type=number id=W> x <input style=width:50 type=number id=H><br><br> &nbsp;<button id=S>üì∑</button> "+`&nbsp;Live Edit <input type=checkbox id=L ${0!=e.info.G?"checked":""}> `+`&nbsp;Sleep <input type=checkbox id=P ${0!=e.info.F?"checked":""}> `+"&nbsp;<button id=G>Save</button> <button id=C>Copy</button> <button id=D>Delete</button> "+`&nbsp;<span id=Z>${e.info.code&&e.info.code.length}</span> Bytes`+"<a id=A><canvas id=V style=display:none>";const s=this.shadowRoot.getElementById("I"),a=this.shadowRoot.getElementById("N"),o=this.shadowRoot.getElementById("W"),r=this.shadowRoot.getElementById("H"),h=this.shadowRoot.getElementById("A"),l=this.shadowRoot.getElementById("V"),d=l.getContext("2d");(t=this.J=this.M.appendChild(document.createElement("textarea"))).id="errorText",t.readOnly=!0,this.shadowRoot.getElementById("C").onmousedown=(()=>Aa(e.u,e)),this.shadowRoot.getElementById("D").onmousedown=(()=>{e.u.C=e.u.C.filter(t=>t.a.info.id!=e.id),this.A(),L=L.filter(t=>t.id!=e.id),OS13k.h(),za(R.D)}),this.shadowRoot.getElementById("G").onmousedown=(()=>h.click(h.href=URL.createObjectURL(new Blob([this.i.value],{type:"text/plain"})),h.download="OS13k_File_"+e.name)),this.X=this.shadowRoot.getElementById("S"),this.X.onmousedown=(()=>{try{h.click(d.fillStyle="#fff",d.fillRect(0,0,l.width=this.j.c.width,l.height=this.j.c.height),d.drawImage(this.j.c,0,0),h.href=l.toDataURL("image/jpeg"),h.download="OS13k_Image_"+e.name)}catch(e){}}),this.Y=this.shadowRoot.getElementById("Z"),this.G=this.shadowRoot.getElementById("L"),this.F=this.shadowRoot.getElementById("P"),a.value=e.name,s.value=e.icon,o.value=e.width,r.value=e.height,s.oninput=a.oninput=this.G.oninput=(()=>{e.I(OS13k.StripHTML(s.value),a.value),e.h(),n(),this.H.I()}),o.onchange=r.onchange=(()=>{e.width=o.value=OS13k.Clamp(o.value,99,720),e.height=r.value=OS13k.Clamp(r.value,99,2*e.width),Oa(this,1),this.b(1,1)}),this.F.oninput=(()=>E(this,1,e.h())),t=e.resize?Math.min(e.width*(e.info.scale||1),innerWidth-6):e.width,this.style.width=t,this.w.style.height=t*e.height/e.width,this.scale=t/e.width,OS13k.Speak(e.name),U+=!I,Pa(this),this.b(1,1)}l(e,t,i){return"C"!=e.id&&this.b(),e==this.name?(N=this,background.style.cursor=taskbar.style.cursor="grabbing",desktop.style.pointerEvents="none",e=this.getBoundingClientRect(),ka=t-e.left,la=i-e.top,Z(45),!1):("full"==e.id&&Na(this),"reload"==e.id&&E(this),"close"==e.id&&this.A(),"shrink"==e.id&&Oa(this,this.scale-.2,75),"grow"==e.id&&Oa(this,this.scale+.2,61),"help"==e.id|"code"==e.id&&Ca(this),/^(?:input|textarea)$/i.test(e.localName))}b(e=1,t){if(xa(),this.className=e?"activeWindow":"",this.O.className="titlebar titlebar"+(e?"Active":"")+(this.a.sticky?"Sticky":this.a.g?"User":""),this.w.style.filter=e||this.a.P?"":"saturate(.7)brightness(.7",e)return I&&!this.a.sticky&&(M=this.a.id,OS13k.h()),U||document.activeElement!=this&&this.j&&this.j.focus(qa=this.B),e=this.getBoundingClientRect(),t&&(this.style.left=OS13k.Clamp(e.x,0,innerWidth-e.width,this.style.top=OS13k.Clamp(e.y,44,Math.max(44,innerHeight-e.height)))),O!=this&&(O&&O.b(0),O=this,this.style.zIndex=++ra,buttonFullScreen.style.display=this.a.S?"":"none",buttonCode.style.display=this.a.code?"":"none",buttonHelp.style.display=this.a.K?"":"none",buttonReload.style.display=this.a.reload?"":"none",buttonResetSize.style.display=this.a.resize?"":"none",this.H&&this.H.b(),!N&&V&&Z(this.V?66:-8),this.V++),!1}A(){this.a.id==M&&(M=""),this.a.h(0),this.a.window=0,this.H&&this.H.remove(),this.remove(),Z(92)}}customElements.define("w-",Ga);class Sa extends HTMLElement{constructor(e,t){super(),this.className="taskbarIcon",this.a=e,this.D=this.W=t,this.I(),taskbarSpace.before(this)}I(){this.innerHTML="<div style=pointer-events:none>"+(this.a.icon||"üí†"),this.title=this.a.name}l(){return this.b(),this==R}b(e=1){e&&this.D.b(1,1),this==R?Z(8,.5):(this.className="taskbarIcon "+(e?"taskbarIconActive":""),e&&(oa&&oa!=this&&oa.b(0),oa=this))}}function Fa(e,t){e.a=t,e.title=t.name,(e=e.appendChild(document.createElement("span"))).innerHTML=t.icon,e.style.pointerEvents="none"}customElements.define("i-",Sa);class Ta extends HTMLElement{constructor(){super(),this.className="trayIcon",tray.appendChild(this)}l(){if(this.a){var e=this.a;O&&O==e.window?e.window.A():e.l()}else this.ba()}}customElements.define("t-",Ta),onmousedown=(e=>{if(V=1,e.target==R&&e.target.D.style.visibility)return xa(),O&&O.b(),!1;if(xa(),programsMenu.style.left=0,programsMenu.style.top=44,N)return onmouseup(e);var t=e.originalTarget||e.path[0];return e.button?"button"!=t.localName&&void(2&e.button&&(((t=e.target.window||e.target).b?t:R).b(),(t=e.target.W?(Z(8,.5),menu):programsMenu).style.left=e.x,t.style.top=e.y,t.style.visibility="visible")):e.target.l?e.target.l(t,e.x,e.y):O&&O.b()}),onmousemove=(e=>{N&&(N.style.left=e.x-ka,N.style.top=e.y-la),e.target.T&&e.target.T()}),onmouseup=(()=>N&&(N.a.h(),Z(42),N.b(1,0),background.style.cursor=taskbar.style.cursor=desktop.style.pointerEvents=N="")),oncontextmenu=(()=>!1),ondragover=(()=>!1),ondrop=(e=>{if("codeText"==(e.originalTarget||e.path[0]).id&&e.target.a.g){const t=e.target,i=new FileReader;i.readAsText(e.dataTransfer.files[0],"UTF-8"),i.onload=(e=>t.b(1,0,Ha(t,t.i.value=e.target.result)))}return!1});var Qa=(...e)=>OS13k.PlaySamples(zzfxG(...e)),zzfxG=(e=1,t=.05,i=220,n=0,s=0,a=.1,o=0,r=1,h=0,l=0,d=0,c=0,u=0,p=0,m=0,g=0,y=0,f=1,S=0,w=44100,b=[])=>{n=99+n*w,s*=w,a*=w,S*=w,y*=w;for(let v=2*Math.PI,k=e=>1+2*e*Math.random()-e,C=e=>0<e?1:-1,O=n+S+s+a+y,M=h*=500*v/w**2,x=i*=k(t)*v/w,L=C(m)*v/4,T=0,R=0,H=0,E=1,I=0,z=0,A=0;H<O;b[H++]=A)++z>100*g&&(z=0,A=T*i*Math.sin(R*m*v/w-L),A=C(A=o?1<o?2<o?3<o?Math.sin((A%v)**3):Math.max(Math.min(Math.tan(A),1),-1):1-(2*A/v%2+2)%2:1-4*Math.abs(Math.round(A/v)-A/v):Math.sin(A))*Math.abs(A)**r,A*=e*(H<n?H/n:H<n+S?1-(H-n)/S*(1-f):H<n+S+s?f:H<O-y?(O-H-y)/a*f:0),A=y?A/2+(y>H?0:(H<O-y?1:(H-O)/y)*b[H-y|0]/2):A),T+=k(p),R+=k(p),i+=h+=500*l*v/w**3,E&&++E>c*w&&(i+=d*v/w,x+=d*v/w,E=0),u&&++I>u*w&&(i=x,h=M,I=1,E=E||1);return b},fa=(e,t,i,n=6,s)=>{let a,o,r,h,l,d,c,u,p,m,g,y,f=44100/(50/n)|0,S=0,w={},b=[],v=[];return i.map(i=>{t[i].map((t,i)=>{for(o=S,u=s?.5+(s[i]||0)/2:1&i,c=0;c<t.length;o+=f)for(m=t[c++]||m,(y=t[c++])&&(p=d=0,w[h=[y,m]]||((g=[...e[m-1]])[2]*=2**((y-12)/12),w[h]=zzfxG(...g)),r=w[h]),p=t[c++]/64||p,a=o;a<o+f;a++)l=r&&r[d++]*(1-p)||0,b[a]=(b[a]||0)+l*(1-u),v[a]=(v[a]||0)+l*u}),S=a}),[b,v]};!function(){var e=H;if(localStorage.OS13k){const e=JSON.parse(localStorage.OS13k);C=e.t,settings=e.s,L=e.Z,M=e.p,ia=e.n}OS13k.h(),A.connect(p.destination),z.connect(p.destination),z.connect(ja),ua=new Ta,D=new Ta,sa=new Ta,ta=new Ta,(G=ua.appendChild(document.createElement("canvas"))).style="width:16;height:16;margin:2;pointer-events:none",onstorage=(e=>va(e.key)),onunload=(()=>e.StopSpeech()),buttonFullScreen.onmousedown=(()=>Na(O)),buttonHelp.onmousedown=buttonCode.onmousedown=(()=>Ca(O)),buttonResetSize.onmousedown=(()=>O.b(1,1,Oa(O,1,61))),buttonReload.onmousedown=(()=>E(O)),buttonClose.onmousedown=(()=>O.A()),(R=new Sa({icon:"üíæ",name:"Load Program"})).D=new Da(aa),za(R.D),OS13k.Trophy("","üëã","Welcome to OS13k!");for(const e in localStorage)va(e);e.U(wa())}()</script>