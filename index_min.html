<html>
<style>
* { font-family: arial; }
body
{
overflow: hidden;
background-image: linear-gradient(#223, #322);
}
</style>
<body>
<script>
const desktopLayout=[{name:"Help",icon:"‚ùì",src:"help.html"},{name:"Games",icon:"üéÆ",folder:[{name:"Queen's Gambit",icon:"<span style=color:#f0f>‚ôõ</span>",src:"games/queensGambit.html",width:1290,height:720},{name:"Free Cell",icon:"‚ô†Ô∏è",src:"games/freeCell.html",width:800,height:1e3,hideWhenClosed:1},{name:"Digit Dilemma",icon:'<span style="font-family:monospace">‚òª</span>',src:"games/digitDilemma.html"},{name:"Hue Jumper",icon:"üå≤",src:"games/hueJumper.html",width:1290,height:720}]},{name:"Utilities",icon:"üîß",folder:[{name:"Test",icon:"‚úåÔ∏è",src:"test.html",hideWhenClosed:1}]},{name:"System",icon:"‚öôÔ∏è",folder:[]},{name:"Toys",icon:"ü§ñ",folder:[]},{name:"Test Folder",folder:[{name:"Mother Goose",icon:"ü¶¢",src:"stories.html"}]},{name:"Test Folder2",folder:[]}],iconGridSizeX=99,iconGridSizeY=130,InitDesktop=e=>{let t=iconGridSizeX/4-iconGridSizeX;const n=e=>{e.x=t+=iconGridSizeX,e.y=iconGridSizeX/4;const n=new OS13kIcon(e);return document.body.appendChild(n),n};for(const e of desktopLayout)n(e)};let topWindow,topIconZ=0,openPos=99;class OS13kIcon extends HTMLElement{constructor({x:e=0,y:t=0,name:n,icon:o,src:s,width:i=500,height:l=500,hideWhenClosed:d,allowMultiple:a,folder:h}){super(),this.shadow=this.attachShadow({mode:"open"}),h&&!o&&(o="üìÅ"),this.name=n,this.icon=o,this.src=s,this.windowWidth=i,this.windowHeight=l,this.SetPos(e,t),this.hideWhenClosed=d||h,this.allowMultiple=a,this.folder=h,this.shadowRoot.innerHTML=`\n        <style>\n        :host\n        {\n            position: absolute;\n            user-select: none;\n            display: flex;\n            align-items: center;\n            flex-direction: column;\n        }\n        .iconImage\n        {\n            width: 64px;\n            height: 64px;\n            font-size: 42px;\n            background-image: linear-gradient(#fff, #999);\n            color: #000;\n            border-radius: 9px;\n            box-shadow: 3px 3px 5px #000F;\n            overflow: hidden;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            white-space: nowrap;\n        }\n        .iconName\n        {\n            text-align: center;\n            font-size: 18px;\n            color: #FFF;\n            text-shadow: 1px 1px 5px #000;\n            position: absolute;\n            top: 70px;\n        }\n\t\t</style>\n        <span class=iconImage id=icon>${o}</span>\n        <span class=iconName id=name>${n}</span>`}SetPos(e,t){this.style.left=e,this.style.top=t}Open(){if(this.os13kWindow&&!this.allowMultiple)return this.os13kWindow.style.display="",void this.os13kWindow.focus();(openPos+=50)>300&&(openPos=50),this.os13kWindow=new OS13kWindow({x:openPos,y:openPos,icon:this}),document.body.appendChild(this.os13kWindow)}MouseDown(){this.parentElement.os13kWindow&&this.parentElement.os13kWindow.focus();const e=this.getBoundingClientRect(),t=new OS13kIcon({x:e.left,y:e.top,name:this.name,icon:this.icon});return t.style.opacity=.5,t.realIcon=this,t.style.zIndex=++topWindowZ,document.body.appendChild(t),t}MouseUp(e){const t=this.getBoundingClientRect();document.body.removeChild(this);let n=t.left,o=t.top;const s=document.elementFromPoint(e.x,e.y);if(s){if("os13k-window"==s.localName){if(!s.os13kIcon.folder)return;const e=t=>{if(t.os13kWindow==s)return 1;if(t.os13kWindow)for(const n of t.os13kWindow.folder.children)if(e(n))return 1};if(e(this.realIcon))return void alert("Recursive folder structure detected!");const t=s.folder.getBoundingClientRect();n-=t.left,o-=t.top,s.folder.appendChild(this.realIcon),s.focus()}else document.body.appendChild(this.realIcon),document.body.focus(),topWindow&&topWindow.SetActive(0),topWindow=0;this.realIcon.SetPos(n,o),this.realIcon.style.zIndex=++topIconZ}}}customElements.define("os13k-icon",OS13kIcon);let selected,seletOffsetX,seletOffsetY,lastMouseDownTarget,lastMouseDownTargetTime,topWindowZ=1e6;class OS13kWindow extends HTMLElement{constructor({x:e,y:t,icon:n}){if(super(),this.maximized=0,this.os13kIcon=n,this.SetPos(e,t),this.style.width=n.windowWidth,this.style.height=n.windowHeight,this.shadow=this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML=`\n        <style>\n        :host\n        {\n            position: absolute;\n            user-select: none;\n            background: #FFF;\n            display: flex;\n            flex-direction: column;\n            border: 2px solid black;\n            box-shadow: 5px 5px 5px #000F;\n            vertical-align: text-top;\n        }\n        .titleBar\n        {\n            font-size: 36px;\n            background: #aac;\n            color: #000;\n        }\n        .frame\n        {\n            position: relative;\n            width: 100%;\n            height: 100%;\n            border: none;\n            overflow: hidden;\n        }\n        .folder\n        {\n            position: relative;\n            width: 100%;\n            height: 100%;\n            border: none;\n            overflow: hidden;\n            background: #222;\n        }\n        .resize\n        {\n            font-size: 25px;\n            color: #000;\n            position: absolute;\n            top: 0; right: 23;\n        }\n        .close\n        {\n            font-size: 40px;\n            color: #000;\n            position: absolute;\n            top: 0; right: 0;\n        }\n\t\t</style>\n        <span id=resize class=resize>üóñ</span>\n        <span id=close class=close>√ó</span>\n        <span id=titleBar class=titleBar>${"&nbsp;"+n.icon+" "+n.name}</span>`,this.titleBar=this.shadowRoot.getElementById("titleBar"),n.folder){const e=document.createElement("div");this.folder=e,e.className="folder",e.os13kWindow=this,this.shadow.appendChild(e),this.focus();let t=iconGridSizeX/4-iconGridSizeX;const o=n=>{n.x=t+=iconGridSizeX,n.y=iconGridSizeX/4,e.appendChild(new OS13kIcon(n))};for(const e of n.folder)o(e)}else if(n.src){const e=document.createElement("iframe");this.frame=e,e.className="frame",e.onload=(e=>{const t=e.target.contentWindow||e.target.contentDocument;t.zzfx=zzfx,t.OS13k=OS13k,t.focus()}),e.src=n.src,this.shadow.appendChild(e)}}SetPos(e,t){this.style.left=e,this.style.top=t}focus(){super.focus(),topWindow&&topWindow.SetActive(0),topWindow=this,this.style.zIndex=++topWindowZ,this.SetActive(1)}SetActive(e=1){this.titleBar.style.background=e?"#aac":"#555"}Close(){this.os13kIcon.hideWhenClosed?this.style.display="none":(this.remove(),this.os13kIcon.os13kWindow=0)}MouseDown(e){this.focus(),"close"==e?this.Close():"resize"==e?this.Resize():"titleBar"==e&&this.frame&&(this.frame.style.pointerEvents="none"),this.SetActive()}MouseUp(){this.frame&&(this.frame.style.pointerEvents="auto")}Resize(){this.maximized=!this.maximized,this.maximized?(this.oldLeft=this.style.left,this.oldTop=this.style.top,this.oldWidth=this.style.width,this.oldHeight=this.style.height,this.style.left=0,this.style.top=0,this.style.width=innerWidth-9,this.style.height=innerHeight-9):(this.style.left=this.oldLeft,this.style.top=this.oldTop,this.style.width=this.oldWidth,this.style.height=this.oldHeight),this.shadowRoot.getElementById("resize").innerHTML=this.maximized?"üóó":"üóñ"}}customElements.define("os13k-window",OS13kWindow);const FindIconInPath=e=>{for(const t of e)if("os13k-icon"==t.localName)return t};onmousedown=(e=>{const t=FindIconInPath(e.path);let n=t||e.target;const o=n.getBoundingClientRect();if(seletOffsetX=e.x-o.left,seletOffsetY=e.y-o.top,t){if(lastMouseDownTarget==n&&lastMouseDownTargetTime>Date.now())return void t.Open();lastMouseDownTarget=n,lastMouseDownTargetTime=Date.now()+300,n=t.MouseDown()}else{if("os13k-window"!=n.localName)return;if(n.MouseDown(e.path[0].id),"titleBar"!=e.path[0].id)return}selected=n}),onmouseup=(e=>{selected&&selected.MouseUp(e),selected=0}),onmousemove=(e=>{selected&&selected.SetPos(e.x-seletOffsetX,e.y-seletOffsetY)});let zzfxV=.3;const zzfx=(e=1,t=.05,n=220,o=0,s=0,i=.1,l=0,d=1,a=0,h=0,c=0,r=0,f=0,p=0,m=0,u=0,w=0,x=2*Math.PI,y=44100,z=(e=>2*e*Math.random()-e),g=(e=>0<e?1:-1),k=(a*=500*x/y**2),S=(n*=(1+z(t))*x/y),W=g(m)*x/4,M=[],I=0,b=0,v=0,C=1,O=0,X=0,T=0,D,B,E,P=zzfxX.createBufferSource())=>{for(h*=500*x/y**3,B=(o=99+o*y|0)+(s=s*y|0)+(i=i*y|0)+(w=w*y|0),m*=x/y,c*=x/y,r*=y,f*=y;v<B;M[v++]=T)++X>100*u&&(X=0,T=I*n*Math.sin(b*m-W),T=g(T=l?1<l?2<l?3<l?Math.sin((T%x)**3):Math.max(Math.min(Math.tan(T),1),-1):1-(2*T/x%2+2)%2:1-4*Math.abs(Math.round(T/x)-T/x):Math.sin(T))*Math.abs(T)**d,T*=e*zzfxV*(v<o?v/o:v<o+s?1:v<B-w?1-(v-o-s)/i:0),T=w?T/2+(w>v?0:(v<B-w?1:(v-B)/w)*M[v-w]/2):T),I+=1+z(p),b+=1+z(p),n+=a+=h,C&&++C>r&&(S+=c,n+=c,C=0),f&&++O>f&&(n=S,a=k,O=1,C=C||1);(E=zzfxX.createBuffer(1,M.length,y)).getChannelData(0).set(M),P.buffer=E,P.connect(zzfxX.destination),P.start()},zzfxX=new(window.AudioContext||webkitAudioContext);zzfxX.z=zzfxX.createBufferSource,zzfxX.createBufferSource=((e=zzfxX.z())=>(e.start=e.start||(e=>zzfxX.noteOn(e)),e));class _OS13k{constructor(){this.lastActiveElement}Alert(e){alert(e)}Update(){const e=document.activeElement;this.lastActiveElement!=e&&("os13k-window"==e.localName&&e.focus(),this.lastActiveElement=e)}}const OS13k=new _OS13k;setInterval(OS13k.Update,100),InitDesktop();
</script>